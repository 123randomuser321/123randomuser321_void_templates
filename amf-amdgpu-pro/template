# Template file for 'amf-amdgpu-pro'
pkgname=amf-amdgpu-pro
version=1.4.23
_distver=21.40.2 # mirrors amdgpu-pro
_magicnum=1350682 # mirrors amdgpu-pro
revision=2
archs="x86_64"
wrksrc=${pkgname}-${version}
create_wrksrc=yes
build_style=meta
hostmakedepends="tar xz"
depends="vulkan-amdgpu-pro>=${_distver}"
short_desc="Proprietary AMDGPU-Pro stack - Advanced Media Framework"
maintainer="Sembo Sadur <labmailssadur@gmail.com>"
license="custom:AMDGPU-Pro"
homepage="https://www.amd.com/en/support"
distfiles="https://repo.radeon.com/amdgpu/${_distver}/ubuntu/pool/proprietary/a/${pkgname}/${pkgname}_${version}-${_magicnum}_amd64.deb"
checksum=0a9e65112e5dbf4a6b7b81d7078381a931657bb803f66ce005ebd4946e423f7f
restricted=yes


_lib64="opt/amdgpu-pro/lib/x86_64-linux-gnu"


do_extract() {
	
	ar x --output ${wrksrc} \
	${XBPS_SRCDISTDIR}/${pkgname}-${version}/${pkgname}_${version}-${_magicnum}_amd64.deb

	tar xpf data.tar.xz

}


do_install() {
	
	vinstall ${_lib64}/libamfrt64.so.1.4.23 755 usr/lib
	ln -s libamfrt64.so.1.4.23 ${DESTDIR}/usr/lib/libamfrt64.so.1
	ln -s libamfrt64.so.1 ${DESTDIR}/usr/lib/libamfrt64.so

	vlicense usr/share/doc/${pkgname}/copyright

}
